<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Overlap corrected LDA · UnfoldDecode.jl</title><meta name="title" content="Overlap corrected LDA · UnfoldDecode.jl"/><meta property="og:title" content="Overlap corrected LDA · UnfoldDecode.jl"/><meta property="twitter:title" content="Overlap corrected LDA · UnfoldDecode.jl"/><meta name="description" content="Documentation for UnfoldDecode.jl."/><meta property="og:description" content="Documentation for UnfoldDecode.jl."/><meta property="twitter:description" content="Documentation for UnfoldDecode.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">UnfoldDecode.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">tutorials</span><ul><li class="is-active"><a class="tocitem" href>Overlap corrected LDA</a><ul class="internal"><li><a class="tocitem" href="#Simulation"><span>Simulation</span></a></li><li><a class="tocitem" href="#Overlap-model-Definition"><span>Overlap-model Definition</span></a></li><li><a class="tocitem" href="#Fitting-the-Overlap-corrected-LDA-model"><span>Fitting the Overlap-corrected LDA model</span></a></li></ul></li></ul></li><li><span class="tocitem">HowTo</span><ul><li><a class="tocitem" href="../../HowTo/overlapcorrectedLDA_options/">Overlap corrected, multi-event, many options, LDA</a></li></ul></li><li><span class="tocitem">BackToBack</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../b2b_quickstart/">Quick Start b2b</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Explanations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../explanations/b2b_why/">Why Back2Back</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../reference/b2b_algorithms/">Algorithm choice</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">tutorials</a></li><li class="is-active"><a href>Overlap corrected LDA</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Overlap corrected LDA</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/unfoldtoolbox/UnfoldDecode.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/unfoldtoolbox/UnfoldDecode.jl/blob/main/docs/literate/tutorials/overlapcorrectedLDA.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><pre><code class="language-julia hljs">using UnfoldDecode
using UnfoldSim
using UnfoldMakie
using CairoMakie
using Unfold</code></pre><h1 id="Overlap-corrected-decoding"><a class="docs-heading-anchor" href="#Overlap-corrected-decoding">Overlap-corrected decoding</a><a id="Overlap-corrected-decoding-1"></a><a class="docs-heading-anchor-permalink" href="#Overlap-corrected-decoding" title="Permalink"></a></h1><p>This approach follows the work of the Deoulle Group, especially Gal Vishne&#39;s work as published 2023: https://doi.org/10.1101/2023.06.28.546397</p><h2 id="Simulation"><a class="docs-heading-anchor" href="#Simulation">Simulation</a><a id="Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation" title="Permalink"></a></h2><p>We start with simulating some continuous, overlapping data with two conditions. As of now, <code>UnfoldSim</code> doesnt support multichannel, so we simply repeat the channel and add some noise`</p><pre><code class="language-julia hljs">dat, evt = UnfoldSim.predef_eeg()
dat = repeat(dat&#39;, 5)
dat .= dat .+ 20 .* rand(size(dat)...)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5×120199 Matrix{Float64}:
  6.18989  17.6872    7.32764   8.63178  …   6.36414   1.28105   1.51064
 12.3692   13.597    17.8781   16.7238      18.6714    7.32533  17.5142
 16.5026   18.5249   14.6792    1.64288      9.36475  14.2187    4.86823
 18.575     2.39232  19.8873   10.1007      12.0763    8.03704  13.7919
 10.6312   14.8267   10.0565   16.47        18.7165   10.2819    8.39622</code></pre><h2 id="Overlap-model-Definition"><a class="docs-heading-anchor" href="#Overlap-model-Definition">Overlap-model Definition</a><a id="Overlap-model-Definition-1"></a><a class="docs-heading-anchor-permalink" href="#Overlap-model-Definition" title="Permalink"></a></h2><p>We have to define what model we want to use for overlap correction We decide for a one-basisfunction model, with one one condition and one covariate, from <code>-0.1</code> to <code>0.5</code> seconds afte the stimulus onset. Sampling rate <code>100</code> as in the simulation</p><pre><code class="language-julia hljs">des = [Any =&gt; (@formula(0 ~ 1 + condition + continuous), firbasis((-0.1, 1.0), 100))];</code></pre><p>Fitting and visualizing a single channel of the model</p><pre><code class="language-julia hljs">uf = Unfold.fit(UnfoldModel, des, evt, dat[1, :]);
plot_erp(coeftable(uf))</code></pre><img src="06748f9f.png" alt="Example block output"/><h2 id="Fitting-the-Overlap-corrected-LDA-model"><a class="docs-heading-anchor" href="#Fitting-the-Overlap-corrected-LDA-model">Fitting the Overlap-corrected LDA model</a><a id="Fitting-the-Overlap-corrected-LDA-model-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting-the-Overlap-corrected-LDA-model" title="Permalink"></a></h2><p>Following the <a href="https://alan-turing-institute.github.io/MLJ.jl/dev/list_of_supported_models/">MLJ Modelzoo</a> we have to do the following to load an LDA model</p><pre><code class="language- hljs">using MLJ, MultivariateStats, MLJMultivariateStatsInterface
LDA = @load LDA pkg = MultivariateStats
uf_lda =
    Unfold.fit(UnfoldDecodingModel, des, evt, dat, LDA(), Any =&gt; :condition; nfolds = 2) # 2 folds to speed up computation
plot_erp(coeftable(uf_lda); mapping = (; color = :coefname))</code></pre><p>Voila, the model classified the correct period.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../">« Home</a><a class="docs-footer-nextpage" href="../../HowTo/overlapcorrectedLDA_options/">Overlap corrected, multi-event, many options, LDA »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Monday 3 March 2025 14:38">Monday 3 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
